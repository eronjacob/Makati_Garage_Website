<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Makati Garage AutoShop</title>
    <link rel="icon" type="images/jpg" href="images/makatigaragelogo.jpg">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            background-color: #e4d9d9;
        }
        
        /* Background Elements */
        .main-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .main-background .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            opacity: 0;
            transition: opacity 1.5s ease-in-out;
            filter: brightness(0.6);
        }
        
        .main-background .slide.active {
            opacity: 1;
        }
        
        .threads-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        /* Auth Container */
        .auth-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 100;
            transition: all 0.5s ease;
        }
        
        .auth-container.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .auth-box {
            background-color: rgb(38, 37, 37);
            border-radius: 10px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 20px rgb(226, 222, 222);
            position: relative;
        }
        
        /* Content Container */
        .content-wrapper {
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
        }
        
        .content-wrapper.visible {
            opacity: 1;
            pointer-events: all;
        }
        
        /* Header with Logo */
        header {
            padding: 1.5rem;
            text-align: center;
            position: relative;
            flex-shrink: 0;
        }
        
        .logo-container {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 120px;
            z-index: 10;
        }
        
        .logo {
            width: 100%;
            height: auto;
            filter: drop-shadow(0 0 5px rgba(246, 235, 235, 0.931));
            transition: transform 0.3s ease;
        }
        
        .logo:hover {
            transform: scale(1.05);
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-top: 1rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
        }
        
        header h3 {
            font-size: 1.3rem;
            margin-top: 0.5rem;
            color: #f00808e6;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
        }
        
        header p {
            font-size: 1.1rem;
            color: #f7eeee;
            margin-top: 0.5rem;
        }
        
        /* Navigation */
        nav {
            display: flex;
            justify-content: center;
            background: rgba(11, 11, 11, 0.899);
            padding: 1rem;
            margin: 1rem auto;
            border-radius: 50px;
            width: fit-content;
            flex-shrink: 0;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            margin: 0 1rem;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            transition: all 0.3s ease;
        }
        
        nav a:hover, nav a.active {
            background: #f00808e6;
            color: white;
        }

        /* Logout Button */
        .logout-btn {
            color: white;
            text-decoration: none;
            margin: 0 1rem;
            padding: 0.5rem 1rem;
            border-radius: 50px;
            transition: all 0.3s ease;
            background: #f00808e6;
            cursor: pointer;
            border: none;
            font-size: 1rem;
        }

        .logout-btn:hover {
            background: #d81e05;
        }
        
        /* Main Content - Centered */
        main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            width: 100%;
        }
        
        .center-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }
        
        .booking-section, .contact-section, .services-section, .my-bookings-section { /* Added .my-bookings-section */
            background-color: rgb(38, 37, 37);
            border-radius: 10px;
            padding: 2rem;
            width: 100%;
            max-width: 800px;
            box-shadow: 0 4px 20px rgb(226, 222, 222);
            backdrop-filter: blur(5px);
            margin: auto;
        }
        
        .booking-section, .contact-section, .my-bookings-section { /* Added .my-bookings-section */
            max-width: 500px;
        }
        
        .booking-section h2, .contact-section h2, .services-section h2, .auth-box h2, .my-bookings-section h2 { /* Added .my-bookings-section h2 */
            text-align: center;
            margin-bottom: 1.5rem;
            color: #f00808e6;
        }
        
        /* Services Grid */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .service-card {
            background: rgba(50, 50, 50, 0.7);
            border-radius: 8px;
            padding: 1.5rem;
            transition: transform 0.3s ease;
            border-left: 4px solid #f00808e6;
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(216, 30, 5, 0.3);
        }

        .service-icon {
            width: 135px;
            height: 135px;
            margin: 0 auto 1rem;
            display: block;
            object-fit: contain;
        }

        .service-title {
            font-size: 1.2rem;
            color: #f00808e6;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .service-description {
            color: #e0e0e0;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Form Styles */
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #f00808e6;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 1rem;
            border-radius: 6px;
            border: 1px solid #eeebeb;
            background-color: rgba(34, 33, 33, 0.983);
            color: white;
            font-size: 1rem;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        button {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(to right, #d81e05, #f0cdb9);
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(216, 30, 5, 0.4);
        }
        
        /* Time Slots Grid */
        .time-slots {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .time-slot {
            padding: 0.6rem;
            text-align: center;
            background-color: rgba(255,255,255,0.1);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .time-slot:hover {
            background-color: rgba(255,255,255,0.2);
        }
        
        .time-slot.selected {
            background-color: #f00808e6;
            color: white;
        }
        
        .time-slot.booked {
            background-color: rgba(255,0,0,0.3);
            cursor: not-allowed;
            text-decoration: line-through;
        }
        
        /* Social Media */
        .social-media {
            display: flex;
            justify-content: center;
            margin: 1.5rem 0;
        }
        
        .social-media a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            margin: 0 0.5rem;
            color: white;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .social-media a:hover {
            background: #f00808e6;
            transform: translateY(-3px);
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 1.5rem;
            background: rgba(0,0,0,0.7);
            flex-shrink: 0;
        }
        
        /* Confirmation Message */
        #confirmation, #contactConfirmation, #loginConfirmation, #loginError, 
        #registerConfirmation, #registerError, #myBookingsMessage { /* Added #myBookingsMessage */
            text-align: center;
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 6px;
            display: none;
        }
        
        #confirmation, #contactConfirmation, #loginConfirmation, #registerConfirmation {
            background-color: rgba(0,255,0,0.2);
            border: 1px solid rgba(0,255,0,0.3);
        }
        
        #loginError, #registerError {
            background-color: rgba(255,0,0,0.2);
            border: 1px solid rgba(255,0,0,0.3);
        }

        #myBookingsMessage { /* Style for no bookings message */
            background-color: rgba(255, 255, 0, 0.2);
            border: 1px solid rgba(255, 255, 0, 0.3);
            color: #fff;
        }

        /* Booking History Display */
        .booking-record {
            background-color: rgba(50, 50, 50, 0.7);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid #f00808e6;
        }

        .booking-record p {
            margin-bottom: 0.5rem;
            color: #e0e0e0;
        }

        .booking-record p strong {
            color: #f00808e6;
        }
        
        /* Page transitions */
        .page {
            display: none;
            width: 100%;
            height: 100%;
        }
        
        .page.active {
            display: flex;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Tabs for auth forms */
        .auth-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #444;
        }
        
        .auth-tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            text-align: center;
            flex: 1;
            color: #aaa;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .auth-tab.active {
            color: white;
        }
        
        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #f00808e6;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .logo-container {
                width: 100px;
                top: 15px;
                right: 15px;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            header h3 {
                font-size: 1.1rem;
            }
            
            header p {
                font-size: 1rem;
            }
            
            .booking-section, .contact-section, .services-section, .auth-box, .my-bookings-section { /* Added .my-bookings-section */
                padding: 1.5rem;
            }
            
            nav {
                flex-wrap: wrap;
                padding: 0.5rem;
            }
            
            nav a {
                margin: 0.3rem;
                padding: 0.3rem 0.8rem;
                font-size: 0.9rem;
            }
            
            .services-grid {
                grid-template-columns: 1fr;
            }
            
            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .time-slots {
                grid-template-columns: 1fr;
            }
            
            .auth-tabs {
                flex-direction: column;
            }
            
            .auth-tab {
                padding: 0.5rem;
                text-align: left;
            }
            
            .auth-tab.active::after {
                width: 30px;
                height: 3px;
                bottom: 0;
            }
            
            .auth-box {
                padding: 1.5rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="main-background" id="main-background">
        <div class="slide active" style="background-image: url('images/backgrounds/backgroundpic1.jpg')"></div>
        <div class="slide" style="background-image: url('images/backgrounds/backgroundpic3.png')"></div>
        <div class="slide" style="background-image: url('images/backgrounds/backgroundpic.jpg')"></div>
        <div class="slide" style="background-image: url('images/backgrounds/background4.png')"></div>
        <div class="slide" style="background-image: url('images/backgrounds/background5.png')"></div>
    </div>

    <div class="threads-container" id="threads-background"></div>

    <div class="auth-container" id="auth-container">
        <div class="auth-box">
            <h2>Welcome to Makati Garage</h2>
            
            <div class="auth-tabs">
                <div class="auth-tab active" data-tab="login">Login</div>
                <div class="auth-tab" data-tab="register">Register</div>
            </div>
            
            <div id="login-form" class="auth-form active">
                <form id="loginForm">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" required placeholder="Enter your email">
                    
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" required placeholder="Enter your password">
                    
                    <button type="submit">Login</button>
                </form>
                
                <div id="loginConfirmation">
                    <h3>Login Successful!</h3>
                    <p>Welcome back! Redirecting to our services...</p>
                </div>
                
                <div id="loginError">
                    <h3>Login Failed</h3>
                    <p id="loginErrorMessage">Invalid email or password. Please try again.</p>
                </div>
            </div>
            
            <div id="register-form" class="auth-form">
                <form id="registerForm">
                    <label for="reg-name">Full Name</label>
                    <input type="text" id="reg-name" required placeholder="Your full name">
                    
                    <label for="reg-email">Email</label>
                    <input type="email" id="reg-email" required placeholder="Your email">
                    
                    <label for="reg-phone">Phone Number</label>
                    <input type="tel" id="reg-phone" required placeholder="Your phone number">
                    
                    <label for="reg-password">Password</label>
                    <input type="password" id="reg-password" required placeholder="Choose a password (min 6 characters)">
                    
                    <label for="reg-confirm-password">Confirm Password</label>
                    <input type="password" id="reg-confirm-password" required placeholder="Confirm your password">
                    
                    <button type="submit">Register</button>
                </form>
                
                <div id="registerConfirmation">
                    <h3>Registration Successful!</h3>
                    <p>You can now login with your credentials.</p>
                </div>
                
                <div id="registerError">
                    <h3>Registration Error</h3>
                    <p id="registerErrorMessage">Please check your inputs and try again.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="content-wrapper" id="content-wrapper">
        <header>
            <div class="logo-container">
                <img src="images/makatigaragelogo.jpg" alt="Makati Garage Logo" class="logo">
            </div>
            <h1>Makati Garage</h1>
            <h3>"DRIVEN BY TRUST. POWERED BY PRECISION"</h3>
            <p>Book for your vehicle repairs at the best garage shop in Sitra, Bahrain</p>
        </header>

        <nav>
            <a href="#" class="nav-link active" data-page="services">Our Services</a>
            <a href="#" class="nav-link" data-page="booking">Book Service</a>
            <a href="#" class="nav-link" data-page="my-bookings">My Bookings</a> <a href="#" class="nav-link" data-page="contact">Contact Us</a>
            <button class="logout-btn" id="logoutBtn">Logout</button>
        </nav>

        <main>
            <div id="booking-page" class="page">
                <div class="center-container">
                    <section class="booking-section">
                        <h2>Book Your Slot</h2>
                        <form id="bookingForm">
                            <label for="name">Full Name</label>
                            <input type="text" id="name" required placeholder="Your name">
                            
                            <label for="email">Email</label>
                            <input type="email" id="email" required placeholder="Your email">
                            
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" required placeholder="Your phone number">
                            
                            <label for="date">Booking Date</label>
                            <input type="date" id="date" required>
                            
                            <label for="time-slot">Available Time Slots</label>
                            <div class="time-slots" id="time-slots-container">
                                </div>
                            <input type="hidden" id="selected-time" name="selected-time" required>
                            
                            <label for="service">Select Service</label>
                            <select id="service" required>
                                <option value="" disabled selected>Select a service</option>
                                <option value="Oil Change">Oil Change</option>
                                <option value="Tire Replacement">Tire Replacement</option>
                                <option value="Engine Check">Engine Check</option>
                                <option value="Car Wash">Car Wash</option>
                                <option value="Full Service">Full Service</option>
                                <option value="Brake Repair">Brake Repair</option>
                            </select>
                            
                            <label for="notes">Special Instructions</label>
                            <textarea id="notes" placeholder="Any special requests or notes about your vehicle"></textarea>
                            
                            <button type="submit">Book Now</button>
                        </form>
                        
                        <div id="confirmation">
                            <h3>Booking Confirmed!</h3>
                            <p>Thank you for choosing Makati Garage. We'll contact you shortly to confirm your appointment.</p>
                        </div>
                    </section>
                </div>
            </div>

            <div id="my-bookings-page" class="page">
                <div class="center-container">
                    <section class="my-bookings-section">
                        <h2>My Booking History</h2>
                        <div id="booking-records-container">
                            </div>
                        <div id="myBookingsMessage">
                            <p>You have no past bookings. Book a service to see your history here!</p>
                        </div>
                    </section>
                </div>
            </div>

            <div id="services-page" class="page active">
                <div class="center-container">
                    <section class="services-section">
                        <h2>Our Services</h2>
                        <div class="services-grid">
                            <div class="service-card">
                                <img src="images/services/oil-change.jpeg" alt="Oil Change" class="service-icon">
                                <h3 class="service-title">Oil Change</h3>
                                <p class="service-description">
                                    Complete oil and filter replacement using premium synthetic or conventional oils. 
                                    Includes fluid level checks and lubrication of chassis components.
                                </p>
                            </div>
                            
                            <div class="service-card">
                                <img src="images/services/tire-change.jpeg" alt="Tire Service" class="service-icon">
                                <h3 class="service-title">Tire Replacement</h3>
                                <p class="service-description">
                                    Professional tire mounting, balancing, and alignment. We carry all major brands 
                                    and offer pressure monitoring system service.
                                </p>
                            </div>
                            
                            <div class="service-card">
                                <img src="images/services/engine-check.webp" alt="Engine Diagnostic" class="service-icon">
                                <h3 class="service-title">Engine Check</h3>
                                <p class="service-description">
                                    Comprehensive diagnostic scanning and tune-up services to optimize performance 
                                    and fuel efficiency. Includes spark plug replacement and system analysis.
                                </p>
                            </div>
                            
                            <div class="service-card">
                                <img src="images/services/car-filter.webp" alt="Car Filter" class="service-icon">
                                <h3 class="service-title">Car Filter</h3>
                                <p class="service-description">
                                    inspecting, cleaning, or replacing filters such as the air filter, oil filter, fuel filter, 
                                    and cabin filter to ensure optimal engine performance, fuel efficiency, 
                                    and clean air circulation inside the vehicle.
                                </p>
                            </div>
                            
                            <div class="service-card">
                                <img src="images/services/brake-repair.webp" alt="Brake Service" class="service-icon">
                                <h3 class="service-title">Brake Repair</h3>
                                <p class="service-description">
                                    Complete brake inspection and service including pad replacement, 
                                    rotor resurfacing, and fluid flush.
                                </p>
                            </div>
                            
                            <div class="service-card">
                                <img src="images/services/battery-repair.jpg" alt="Battery Service" class="service-icon">
                                <h3 class="service-title">Battery Service</h3>
                                <p class="service-description">
                                    Battery testing, replacement, and charging system diagnostics. 
                                    We handle proper disposal of old batteries.
                                </p>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <div id="contact-page" class="page">
                <div class="center-container">
                    <section class="contact-section">
                        <h2>Contact Us</h2>
                        <form id="contactForm">
                            <label for="contact-name">Your Name</label>
                            <input type="text" id="contact-name" required placeholder="Your name">
                            
                            <label for="contact-email">Email</label>
                            <input type="email" id="contact-email" required placeholder="Your email">
                            
                            <label for="contact-phone">Phone Number</label>
                            <input type="tel" id="contact-phone" placeholder="Your phone number">
                            
                            <label for="subject">Subject</label>
                            <input type="text" id="subject" required placeholder="Subject">
                            
                            <label for="message">Message</label>
                            <textarea id="message" required placeholder="Your message"></textarea>
                            
                            <button type="submit">Send Message</button>
                        </form>
                        
                        <div id="contactConfirmation">
                            <h3>Message Sent!</h3>
                            <p>Thank you for contacting Makati Garage. We'll get back to you soon.</p>
                        </div>

                        <div class="social-media">
                            <a href="https://facebook.com" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                            <a href="https://instagram.com" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                            <a href="https://twitter.com" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                            <a href="https://wa.me/97312345678" target="_blank" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                            <a href="tel:+97312345678" aria-label="Phone"><i class="fas fa-phone"></i></a>
                        </div>

                        <div style="text-align: center; margin-top: 1.5rem;">
                            <p><i class="fas fa-map-marker-alt"></i> Sitra, Bahrain</p>
                            <p><i class="fas fa-clock"></i> Open 7 Days a Week: 8AM - 10PM</p>
                            <p><i class="fas fa-phone"></i> +973 1234 5678</p>
                            <p><i class="fas fa-envelope"></i> info@makatigarage.com</p>
                        </div>
                    </section>
                </div>
            </div>
        </main>

        <footer>
            <p>Â© 2025 Makati Garage. All rights reserved.</p>
            <div class="social-media" style="margin: 0.5rem 0;">
                <a href="https://facebook.com" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="https://instagram.com" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://twitter.com" target="_blank" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
            </div>
        </footer>
    </div>

    <script>
        class Threads {
            constructor({ target, props = {} }) {
                this.container = target;
                this.props = {
                    color: [1, 1, 1],
                    amplitude: 1,
                    distance: 0,
                    enableMouseInteraction: false,
                    ...props
                };
                
                this.animationFrameId = null;
                this.init();
            }
            
            init() {
                if (!this.container) return;
                
                // Create renderer
                this.renderer = new Renderer({ alpha: true });
                this.gl = this.renderer.gl;
                this.gl.clearColor(0, 0, 0, 0);
                this.gl.enable(this.gl.BLEND);
                this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);
                this.container.appendChild(this.gl.canvas);
                
                // Create geometry and program
                this.geometry = new Triangle(this.gl);
                this.program = new Program(this.gl, {
                    vertex: `
                        attribute vec2 position;
                        attribute vec2 uv;
                        varying vec2 vUv;
                        void main() {
                            vUv = uv;
                            gl_Position = vec4(position, 0.0, 1.0);
                        }
                    `,
                    fragment: `
                        precision highp float;
                        uniform float iTime;
                        uniform vec3 iResolution;
                        uniform vec3 uColor;
                        uniform float uAmplitude;
                        uniform float uDistance;
                        uniform vec2 uMouse;
                        #define PI 3.1415926538
                        const int u_line_count = 40;
                        const float u_line_width = 7.0;
                        const float u_line_blur = 10.0;
                        
                        float Perlin2D(vec2 P) {
                            vec2 Pi = floor(P);
                            vec4 Pf_Pfmin1 = P.xyxy - vec4(Pi, Pi + 1.0);
                            vec4 Pt = vec4(Pi.xy, Pi.xy + 1.0);
                            Pt = Pt - floor(Pt * (1.0 / 71.0)) * 71.0;
                            Pt += vec2(26.0, 161.0).xyxy;
                            Pt *= Pt;
                            Pt = Pt.xzxz * Pt.yyww;
                            vec4 hash_x = fract(Pt * (1.0 / 951.135664));
                            vec4 hash_y = fract(Pt * (1.0 / 642.949883));
                            vec4 grad_x = hash_x - 0.49999;
                            vec4 grad_y = hash_y - 0.49999;
                            vec4 grad_results = inversesqrt(grad_x * grad_x + grad_y * grad_y)
                                * (grad_x * Pf_Pfmin1.xzxz + grad_y * Pf_Pfmin1.yyww);
                            grad_results *= 1.4142135623730950;
                            vec2 blend = Pf_Pfmin1.xy * Pf_Pfmin1.xy * Pf_Pfmin1.xy
                                         * (Pf_Pfmin1.xy * (Pf_Pfmin1.xy * 6.0 - 15.0) + 10.0);
                            vec4 blend2 = vec4(blend, vec2(1.0 - blend));
                            return dot(grad_results, blend2.zxzx * blend2.wwyy);
                        }
                        
                        float pixel(float count, vec2 resolution) {
                            return (1.0 / max(resolution.x, resolution.y)) * count;
                        }
                        
                        float lineFn(vec2 st, float width, float perc, float offset, vec2 mouse, float time, float amplitude, float distance) {
                            float split_offset = (perc * 0.4);
                            float split_point = 0.1 + split_offset;
                            float amplitude_normal = smoothstep(split_point, 0.7, st.x);
                            float amplitude_strength = 0.5;
                            float finalAmplitude = amplitude_normal * amplitude_strength
                                                    * amplitude * (1.0 + (mouse.y - 0.5) * 0.2);
                            float time_scaled = time / 10.0 + (mouse.x - 0.5) * 1.0;
                            float blur = smoothstep(split_point, split_point + 0.05, st.x) * perc;
                            float xnoise = mix(
                                Perlin2D(vec2(time_scaled, st.x + perc) * 2.5),
                                Perlin2D(vec2(time_scaled, st.x + time_scaled) * 3.5) / 1.5,
                                st.x * 0.3
                            );
                            float y = 0.5 + (perc - 0.5) * distance + xnoise / 2.0 * finalAmplitude;
                            float line_start = smoothstep(
                                y + (width / 2.0) + (u_line_blur * pixel(1.0, iResolution.xy) * blur),
                                y,
                                st.y
                            );
                            float line_end = smoothstep(
                                y,
                                y - (width / 2.0) - (u_line_blur * pixel(1.0, iResolution.xy) * blur),
                                st.y
                            );
                            return clamp(
                                (line_start - line_end) * (1.0 - smoothstep(0.0, 1.0, pow(perc, 0.3))),
                                0.0,
                                1.0
                            );
                        }
                        
                        void mainImage(out vec4 fragColor, in vec2 fragCoord) {
                            vec2 uv = fragCoord / iResolution.xy;
                            float line_strength = 1.0;
                            for (int i = 0; i < u_line_count; i++) {
                                float p = float(i) / float(u_line_count);
                                line_strength *= (1.0 - lineFn(
                                    uv,
                                    u_line_width * pixel(1.0, iResolution.xy) * (1.0 - p),
                                    p,
                                    (PI * 1.0) * p,
                                    uMouse,
                                    iTime,
                                    uAmplitude,
                                    uDistance
                                ));
                            }
                            float colorVal = 1.0 - line_strength;
                            fragColor = vec4(uColor * colorVal, colorVal);
                        }
                        
                        void main() {
                            mainImage(gl_FragColor, gl_FragCoord.xy);
                        }
                    `,
                    uniforms: {
                        iTime: { value: 0 },
                        iResolution: { value: new Color() },
                        uColor: { value: new Color(...this.props.color) },
                        uAmplitude: { value: this.props.amplitude },
                        uDistance: { value: this.props.distance },
                        uMouse: { value: new Float32Array([0.5, 0.5]) },
                    },
                });
                
                // Create mesh
                this.mesh = new Mesh(this.gl, { geometry: this.geometry, program: this.program });
                
                // Setup resize handler
                this.resize();
                window.addEventListener('resize', this.resize.bind(this));
                
                // Mouse interaction setup
                this.currentMouse = [0.5, 0.5];
                this.targetMouse = [0.5, 0.5];
                
                if (this.props.enableMouseInteraction) {
                    this.container.addEventListener('mousemove', this.handleMouseMove.bind(this));
                    this.container.addEventListener('mouseleave', this.handleMouseLeave.bind(this));
                }
                
                // Start animation
                this.animationFrameId = requestAnimationFrame(this.update.bind(this));
            }
            
            resize() {
                const { clientWidth, clientHeight } = this.container;
                this.renderer.setSize(clientWidth, clientHeight);
                this.program.uniforms.iResolution.value.r = clientWidth;
                this.program.uniforms.iResolution.value.g = clientHeight;
                this.program.uniforms.iResolution.value.b = clientWidth / clientHeight;
            }
            
            handleMouseMove(e) {
                const rect = this.container.getBoundingClientRect();
                const x = (e.clientX - rect.left) / rect.width;
                const y = 1.0 - (e.clientY - rect.top) / rect.height;
                this.targetMouse = [x, y];
            }
            
            handleMouseLeave() {
                this.targetMouse = [0.5, 0.5];
            }
            
            update(t) {
                if (this.props.enableMouseInteraction) {
                    const smoothing = 0.05;
                    this.currentMouse[0] += smoothing * (this.targetMouse[0] - this.currentMouse[0]);
                    this.currentMouse[1] += smoothing * (this.targetMouse[1] - this.currentMouse[1]);
                    this.program.uniforms.uMouse.value[0] = this.currentMouse[0];
                    this.program.uniforms.uMouse.value[1] = this.currentMouse[1];
                } else {
                    this.program.uniforms.uMouse.value[0] = 0.5;
                    this.program.uniforms.uMouse.value[1] = 0.5;
                }
                
                this.program.uniforms.iTime.value = t * 0.001;
                this.renderer.render({ scene: this.mesh });
                this.animationFrameId = requestAnimationFrame(this.update.bind(this));
            }
            
            destroy() {
                if (this.animationFrameId) cancelAnimationFrame(this.animationFrameId);
                window.removeEventListener('resize', this.resize.bind(this));
                
                if (this.props.enableMouseInteraction) {
                    this.container.removeEventListener('mousemove', this.handleMouseMove.bind(this));
                    this.container.removeEventListener('mouseleave', this.handleMouseLeave.bind(this));
                }
                
                if (this.container.contains(this.gl.canvas)) {
                    this.container.removeChild(this.gl.canvas);
                }
                
                this.gl.getExtension('WEBGL_lose_context')?.loseContext();
            }
        }

        // Dummy OGL library components (as they were in your original code, required for 'Threads' class)
        class Color extends Float32Array {
            constructor(r = 0, g = 0, b = 0) {
                super([r, g, b]);
            }
        }

        class Vec2 extends Float32Array {
            constructor(x = 0, y = 0) {
                super([x, y]);
            }
        }

        class Triangle {
            constructor(gl) {
                this.gl = gl;
                this.positionBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);
                gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, 3, -1, -1, 3]), gl.STATIC_DRAW);
                
                this.uvBuffer = gl.createBuffer();
                gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);
                gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([0, 0, 2, 0, 0, 2]), gl.STATIC_DRAW);
            }
        }

        class Program {
            constructor(gl, { vertex, fragment, uniforms }) {
                this.gl = gl;
                this.uniforms = uniforms;

                const vertexShader = gl.createShader(gl.VERTEX_SHADER);
                gl.shaderSource(vertexShader, vertex);
                gl.compileShader(vertexShader);

                const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
                gl.shaderSource(fragmentShader, fragment);
                gl.compileShader(fragmentShader);

                this.program = gl.createProgram();
                gl.attachShader(this.program, vertexShader);
                gl.attachShader(this.program, fragmentShader);
                gl.linkProgram(this.program);

                this.compileUniforms();
            }

            compileUniforms() {
                this.uniformLocations = {};
                for (const key in this.uniforms) {
                    this.uniformLocations[key] = this.gl.getUniformLocation(this.program, key);
                }
            }

            use() {
                this.gl.useProgram(this.program);
                for (const key in this.uniforms) {
                    const uniform = this.uniforms[key];
                    const location = this.uniformLocations[key];
                    if (location === null) continue; // Uniform not found or optimized out

                    if (uniform.value instanceof Color) {
                        this.gl.uniform3fv(location, uniform.value);
                    } else if (uniform.value instanceof Float32Array && uniform.value.length === 2) {
                        this.gl.uniform2fv(location, uniform.value);
                    } else if (typeof uniform.value === 'number') {
                        this.gl.uniform1f(location, uniform.value);
                    }
                    // Add more uniform types as needed (e.g., matrices, textures)
                }
            }
        }

        class Mesh {
            constructor(gl, { geometry, program }) {
                this.gl = gl;
                this.geometry = geometry;
                this.program = program;
            }
        }

        class Renderer {
            constructor({ gl, alpha = false }) {
                this.gl = gl || document.createElement('canvas').getContext('webgl', { alpha });
                if (!gl) document.body.appendChild(this.gl.canvas);
            }

            setSize(width, height) {
                this.gl.canvas.width = width;
                this.gl.canvas.height = height;
                this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);
            }

            render({ scene }) {
                this.gl.clear(this.gl.COLOR_BUFFER_BIT);
                scene.program.use();
                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, scene.geometry.positionBuffer);
                const positionLoc = this.gl.getAttribLocation(scene.program.program, 'position');
                this.gl.enableVertexAttribArray(positionLoc);
                this.gl.vertexAttribPointer(positionLoc, 2, this.gl.FLOAT, false, 0, 0);

                this.gl.bindBuffer(this.gl.ARRAY_BUFFER, scene.geometry.uvBuffer);
                const uvLoc = this.gl.getAttribLocation(scene.program.program, 'uv');
                this.gl.enableVertexAttribArray(uvLoc);
                this.gl.vertexAttribPointer(uvLoc, 2, this.gl.FLOAT, false, 0, 0);

                this.gl.drawArrays(this.gl.TRIANGLES, 0, 3);
            }
        }


    </script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const authContainer = document.getElementById('auth-container');
            const contentWrapper = document.getElementById('content-wrapper');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const logoutBtn = document.getElementById('logoutBtn');
            const authTabs = document.querySelectorAll('.auth-tab');
            const loginConfirmation = document.getElementById('loginConfirmation');
            const loginError = document.getElementById('loginError');
            const loginErrorMessage = document.getElementById('loginErrorMessage');
            const registerConfirmation = document.getElementById('registerConfirmation');
            const registerError = document.getElementById('registerError');
            const registerErrorMessage = document.getElementById('registerErrorMessage');

            const navLinks = document.querySelectorAll('.nav-link');
            const pages = document.querySelectorAll('.page');

            const bookingForm = document.getElementById('bookingForm');
            const confirmationMessage = document.getElementById('confirmation');
            const contactForm = document.getElementById('contactForm');
            const contactConfirmation = document.getElementById('contactConfirmation');

            const timeSlotsContainer = document.getElementById('time-slots-container');
            const selectedTimeInput = document.getElementById('selected-time');
            const myBookingsPage = document.getElementById('my-bookings-page'); // New
            const bookingRecordsContainer = document.getElementById('booking-records-container'); // New
            const myBookingsMessage = document.getElementById('myBookingsMessage'); // New

            // User data and current user tracking
            let users = JSON.parse(localStorage.getItem('users')) || [];
            let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

            // Booking data storage
            let allBookings = JSON.parse(localStorage.getItem('allBookings')) || [];

            // --- Background Slideshow ---
            let slideIndex = 0;
            const slides = document.querySelectorAll('.main-background .slide');

            function showSlides() {
                slides.forEach((slide, i) => {
                    slide.classList.remove('active');
                    if (i === slideIndex) {
                        slide.classList.add('active');
                    }
                });
                slideIndex = (slideIndex + 1) % slides.length;
                setTimeout(showSlides, 5000); // Change image every 5 seconds
            }
            showSlides();

            // --- Threads Background Animation ---
            new Threads({
                target: document.getElementById('threads-background'),
                props: {
                    color: [240 / 255, 8 / 255, 8 / 255], // Red color from your style
                    amplitude: 1.0,
                    distance: 0.8,
                    enableMouseInteraction: true
                }
            });

            // --- Auth Tab Switching ---
            authTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    authTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    document.querySelectorAll('.auth-form').forEach(form => {
                        form.classList.remove('active');
                    });
                    document.getElementById(tab.dataset.tab + '-form').classList.add('active');
                    // Hide any previous messages
                    loginConfirmation.style.display = 'none';
                    loginError.style.display = 'none';
                    registerConfirmation.style.display = 'none';
                    registerError.style.display = 'none';
                });
            });

            // --- Login Logic ---
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = document.getElementById('login-email').value;
                const password = document.getElementById('login-password').value;

                const user = users.find(u => u.email === email && u.password === password);

                if (user) {
                    currentUser = user;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    loginConfirmation.style.display = 'block';
                    loginError.style.display = 'none';
                    setTimeout(() => {
                        authContainer.classList.add('hidden');
                        contentWrapper.classList.add('visible');
                        showPage('services-page'); // Show services page after login
                        updateAuthFormFields(); // Update form fields with user data
                    }, 1000);
                } else {
                    loginError.style.display = 'block';
                    loginErrorMessage.textContent = 'Invalid email or password. Please try again.';
                    loginConfirmation.style.display = 'none';
                }
            });

            // --- Registration Logic ---
            registerForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('reg-name').value;
                const email = document.getElementById('reg-email').value;
                const phone = document.getElementById('reg-phone').value;
                const password = document.getElementById('reg-password').value;
                const confirmPassword = document.getElementById('reg-confirm-password').value;

                if (password.length < 6) {
                    registerError.style.display = 'block';
                    registerErrorMessage.textContent = 'Password must be at least 6 characters long.';
                    registerConfirmation.style.display = 'none';
                    return;
                }

                if (password !== confirmPassword) {
                    registerError.style.display = 'block';
                    registerErrorMessage.textContent = 'Passwords do not match.';
                    registerConfirmation.style.display = 'none';
                    return;
                }

                if (users.some(u => u.email === email)) {
                    registerError.style.display = 'block';
                    registerErrorMessage.textContent = 'Email already registered. Please login or use a different email.';
                    registerConfirmation.style.display = 'none';
                    return;
                }

                const newUser = { id: Date.now(), name, email, phone, password };
                users.push(newUser);
                localStorage.setItem('users', JSON.stringify(users));

                registerConfirmation.style.display = 'block';
                registerError.style.display = 'none';
                // Automatically switch to login tab after successful registration
                setTimeout(() => {
                    document.querySelector('.auth-tab[data-tab="login"]').click();
                    document.getElementById('login-email').value = email;
                }, 1500);
            });

            // --- Logout Logic ---
            logoutBtn.addEventListener('click', () => {
                currentUser = null;
                localStorage.removeItem('currentUser');
                authContainer.classList.remove('hidden');
                contentWrapper.classList.remove('visible');
                // Clear form fields
                loginForm.reset();
                registerForm.reset();
                // Reset auth messages
                loginConfirmation.style.display = 'none';
                loginError.style.display = 'none';
                registerConfirmation.style.display = 'none';
                registerError.style.display = 'none';
                // Ensure login tab is active
                document.querySelector('.auth-tab[data-tab="login"]').click();
            });

            // Check if user is already logged in on page load
            if (currentUser) {
                authContainer.classList.add('hidden');
                contentWrapper.classList.add('visible');
                showPage('services-page'); // Show services page if logged in
                updateAuthFormFields(); // Populate booking form fields
            }

            // --- Navigation Logic ---
            function showPage(pageId) {
                pages.forEach(page => page.classList.remove('active'));
                document.getElementById(pageId).classList.add('active');

                navLinks.forEach(link => link.classList.remove('active'));
                document.querySelector(`.nav-link[data-page="${pageId.replace('-page', '')}"]`).classList.add('active');
                
                // If My Bookings page is opened, load bookings
                if (pageId === 'my-bookings-page') {
                    loadUserBookings();
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    showPage(link.dataset.page + '-page');
                });
            });

            // --- Booking Form Functionality ---
            const availableTimeSlots = [
                '08:00 AM', '09:00 AM', '10:00 AM', '11:00 AM',
                '01:00 PM', '02:00 PM', '03:00 PM', '04:00 PM',
                '05:00 PM', '06:00 PM', '07:00 PM', '08:00 PM',
            ];

            function generateTimeSlots(selectedDate) {
                timeSlotsContainer.innerHTML = '';
                selectedTimeInput.value = ''; // Clear previously selected time

                const today = new Date();
                today.setHours(0, 0, 0, 0); // Normalize to start of day
                const inputDate = new Date(selectedDate);
                inputDate.setHours(0, 0, 0, 0);

                const isToday = inputDate.getTime() === today.getTime();

                availableTimeSlots.forEach(time => {
                    const timeSlotDiv = document.createElement('div');
                    timeSlotDiv.classList.add('time-slot');
                    timeSlotDiv.textContent = time;
                    timeSlotDiv.dataset.time = time;

                    let isBooked = false;
                    // Check if the slot is booked for the selected date
                    if (selectedDate) {
                        isBooked = allBookings.some(booking => 
                            booking.date === selectedDate && booking.time === time
                        );
                    }
                    
                    if (isBooked) {
                        timeSlotDiv.classList.add('booked');
                    } else {
                        // Disable past times for today
                        if (isToday) {
                            const [hour, minutePart] = time.split(':');
                            const currentHour = new Date().getHours();
                            const currentMinute = new Date().getMinutes();
                            let slotHour = parseInt(hour);
                            const ampm = minutePart.split(' ')[1];

                            if (ampm === 'PM' && slotHour !== 12) {
                                slotHour += 12;
                            }
                            if (ampm === 'AM' && slotHour === 12) { // Midnight case for 12 AM
                                slotHour = 0; 
                            }
                            
                            if (slotHour < currentHour || (slotHour === currentHour && parseInt(minutePart) <= currentMinute)) {
                                timeSlotDiv.classList.add('booked'); // Treat past times as booked/unavailable
                            } else {
                                timeSlotDiv.addEventListener('click', () => {
                                    document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
                                    timeSlotDiv.classList.add('selected');
                                    selectedTimeInput.value = time;
                                });
                            }
                        } else {
                            timeSlotDiv.addEventListener('click', () => {
                                document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
                                timeSlotDiv.classList.add('selected');
                                selectedTimeInput.value = time;
                            });
                        }
                    }
                    timeSlotsContainer.appendChild(timeSlotDiv);
                });
            }

            // Event listener for date input change to refresh time slots
            document.getElementById('date').addEventListener('change', (e) => {
                generateTimeSlots(e.target.value);
            });

            // Initial generation of time slots for the current date or default
            const todayDate = new Date().toISOString().slice(0, 10);
            document.getElementById('date').value = todayDate;
            document.getElementById('date').min = todayDate; // Prevent selecting past dates
            generateTimeSlots(todayDate);

            bookingForm.addEventListener('submit', (e) => {
                e.preventDefault();

                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const phone = document.getElementById('phone').value;
                const date = document.getElementById('date').value;
                const time = selectedTimeInput.value; // Get from hidden input
                const service = document.getElementById('service').value;
                const notes = document.getElementById('notes').value;

                if (!time) {
                    alert('Please select a time slot.');
                    return;
                }

                // Check if the selected slot is already booked
                const isBooked = allBookings.some(booking => 
                    booking.date === date && booking.time === time
                );

                if (isBooked) {
                    alert('This time slot is already booked. Please choose another one.');
                    return;
                }

                // Create a booking object
                const bookingDetails = {
                    id: Date.now(), // Unique ID for the booking
                    userId: currentUser ? currentUser.id : 'guest', // Link booking to user
                    name,
                    email,
                    phone,
                    date,
                    time,
                    service,
                    notes,
                    status: 'Pending' // You can add a status
                };

                // Add to all bookings
                allBookings.push(bookingDetails);
                localStorage.setItem('allBookings', JSON.stringify(allBookings));

                // Show confirmation message
                confirmationMessage.style.display = 'block';
                bookingForm.reset();
                selectedTimeInput.value = ''; // Clear selected time
                // Regenerate time slots to mark the newly booked one
                generateTimeSlots(document.getElementById('date').value);

                // Hide confirmation after a few seconds
                setTimeout(() => {
                    confirmationMessage.style.display = 'none';
                }, 5000);
            });

            // --- Contact Form Functionality ---
            contactForm.addEventListener('submit', (e) => {
                e.preventDefault();

                contactConfirmation.style.display = 'block';
                contactForm.reset();

                setTimeout(() => {
                    contactConfirmation.style.display = 'none';
                }, 5000);
            });

            // --- Update Booking Form with Current User Data ---
            function updateAuthFormFields() {
                if (currentUser) {
                    document.getElementById('name').value = currentUser.name || '';
                    document.getElementById('email').value = currentUser.email || '';
                    document.getElementById('phone').value = currentUser.phone || '';
                } else {
                    document.getElementById('name').value = '';
                    document.getElementById('email').value = '';
                    document.getElementById('phone').value = '';
                }
            }

            // --- My Bookings Feature ---
            function loadUserBookings() {
                bookingRecordsContainer.innerHTML = ''; // Clear previous bookings

                const userBookings = allBookings.filter(booking => 
                    currentUser && booking.userId === currentUser.id
                );

                if (userBookings.length === 0) {
                    myBookingsMessage.style.display = 'block';
                } else {
                    myBookingsMessage.style.display = 'none';
                    userBookings.forEach(booking => {
                        const bookingRecordDiv = document.createElement('div');
                        bookingRecordDiv.classList.add('booking-record');
                        bookingRecordDiv.innerHTML = `
                            <p><strong>Service:</strong> ${booking.service}</p>
                            <p><strong>Date:</strong> ${booking.date}</p>
                            <p><strong>Time:</strong> ${booking.time}</p>
                            <p><strong>Status:</strong> ${booking.status}</p>
                            ${booking.notes ? `<p><strong>Notes:</strong> ${booking.notes}</p>` : ''}
                        `;
                        bookingRecordsContainer.appendChild(bookingRecordDiv);
                    });
                }
            }
        });
    </script>
</body>
</html>